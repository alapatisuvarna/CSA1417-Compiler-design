#include<stdio.h>
#include<string.h>

char input[50];
int i = 0;
int error = 0;

void E();
void Edash();
void T();
void Tdash();
void F();

void match(char c)
{
    if(input[i] == c)
        i++;
    else
        error = 1;
}

void E()
{
    T();
    Edash();
}

void Edash()
{
    if(input[i] == '+')
    {
        match('+');
        T();
        Edash();
    }
}

void T()
{
    F();
    Tdash();
}

void Tdash()
{
    if(input[i] == '*')
    {
        match('*');
        F();
        Tdash();
    }
}

void F()
{
    if(input[i] == 'i')     // i represents id
        match('i');
    else if(input[i] == '(')
    {
        match('(');
        E();
        match(')');
    }
    else
        error = 1;
}

int main()
{
    printf("Enter input string (use i for id): ");
    scanf("%s", input);

    E();

    if(i == strlen(input) && error == 0)
        printf("String Accepted\n");
    else
        printf("String Rejected\n");

    return 0;
}
